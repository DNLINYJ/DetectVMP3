import re

def read_file_as_hex(filepath):
    with open(filepath, 'rb') as file:
        content = file.read()
    return content.hex().upper()

def search_hex_pattern(hex_pattern, hex_string):
    hex_pattern = hex_pattern.replace("?", "[0-9a-f]")
    return re.findall(hex_pattern, hex_string, flags=re.IGNORECASE)

filepath = input("[-] Please input the path of file you want to detect: ")

watermark = "50F01FFDFD8??7926???B4??C2???07?4?????C?C??F?D2?6??19CBF0?9912?717??3635CA8A?7?0???F?C?D7D7??9E5?1?84E4???24??D45?5?C?04B9E?D?2?15?89??6?784?????D9??1?1?E??03?????446?6???3EC941E?6A??4?5????????8?C??8???2???0C8EB?C1?D?4?"

hex_file_content = read_file_as_hex(filepath)
match_results = search_hex_pattern(watermark, hex_file_content)

if match_results:
    print("[+] The file maybe protected by VMP3.")
else:
    print("[-] The file maybe didn't protected by VMP3.")
